(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[538],{75906:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/map",function(){return n(81867)}])},81867:function(t,e,n){"use strict";n.r(e),n.d(e,{ContactMap:function(){return ContactMap},__N_SSP:function(){return l},default:function(){return MapPage}});var o=n(52322),a=n(2784),i=n(4802),c=n(93376),l=!0;function MapPage(t){let[e,n]=(0,a.useState)(!1),[l,r]=(0,a.useState)(!1),{findSoloDomain:s}=(0,c.o5)();async function isValidParentDomain(){let t=new URL(document.referrer).hostname;if(!t)return!1;let e="localhost"===t||"main.soloist.ai"===t||"soloist.ai"===t;if(e)return console.log("Allowing access to ".concat(t)),!0;try{let e=await s(t);console.log("Parent domain:",e);let n=!!(e&&e.state===i.WebsiteDomainState.Connected);return console.log("Access to ".concat(t," is ").concat(n?"allowed":"not allowed")),n}catch(e){return console.error("Error checking domain ".concat(t,": ").concat(e),e),!1}}return((0,a.useEffect)(()=>{(async()=>{let t=window.self!==window.top,e=window.location.hostname,o=t&&("soloist.ai"===e||"main.soloist.ai"===e||"localhost"===e)&&await isValidParentDomain();console.log("iFrame hostname ".concat(e," is ").concat(o?"allowed":"not allowed")),n(o),r(!0)})()},[]),!t.error&&l&&e)?(0,o.jsx)(ContactMap,{...t}):null}function ContactMap(t){let{address:e,latitude:n,longitude:i,markerTitle:c}=t,[l,r]=(0,a.useState)(),[s,p]=(0,a.useState)();async function appendSetupScriptOnce(){window.initMap||(window.initMap=initMapAndMarker);let t="google-maps-script",e=document.querySelector('script[id="'.concat(t,'"]'));if(e&&!l&&initMapAndMarker(n,i),!e){let e=document.createElement("script");e.id=t,e.src=await getGoogleMapsScriptUrl(n,i),e.async=!0,e.defer=!0,document.head.appendChild(e)}}async function getGoogleMapsScriptUrl(t,e){let n=await fetch("/api/location/maps",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({latitude:t||0,longitude:e||0,callbackFunctionName:"initMap"})}),o=await n.json();if(!n.ok)throw Error(o);return o.url}function initMapAndMarker(t,n){let o=window.google.maps,a=t&&n?{lat:t,lng:n}:{lat:37.7857705,lng:-122.5091086},i=new o.Map(document.getElementById("map"),{center:a,zoom:12,mapTypeControl:!1,scrollwheel:!1,mapId:"SOLO_DEFAULT_MAP"});r(i);let l=new o.marker.AdvancedMarkerElement({position:a,map:i,title:c}),s="https://www.google.com/maps/dir//".concat(encodeURIComponent(c),",").concat(encodeURIComponent(e));l.addListener("click",()=>window.open(s,"_blank")),p(l)}return(0,a.useEffect)(()=>{appendSetupScriptOnce()},[]),(0,a.useEffect)(()=>{if(!l||!n||!i)return;let t={lat:n,lng:i};l.setCenter(t),s&&(s.position=t)},[l,s,n,i]),(0,a.useEffect)(()=>{s&&(s.title=c)},[c,s]),(0,o.jsx)("div",{id:"map",style:{position:"absolute",top:0,left:0,right:0,bottom:0}})}}},function(t){t.O(0,[774,888,179],function(){return t(t.s=75906)}),_N_E=t.O()}]);